<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>progressr: An Introduction • progressr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="progressr: An Introduction">
<meta property="og:description" content="progressr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SB3EQSD9FR"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SB3EQSD9FR');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">progressr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.12.0-9022</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/progressr-intro.html">progressr: An Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.futureverse.org/" class="external-link">
    <span class="fas fa-fast-backward"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://BiocParallel.FutureParam.futureverse.org" class="external-link">BiocParallel.FutureParam</a>
    </li>
    <li>
      <a href="https://doFuture.futureverse.org" class="external-link">doFuture</a>
    </li>
    <li>
      <a href="https://furrr.futureverse.org" class="external-link">furrr</a>
    </li>
    <li>
      <a href="https://future.futureverse.org" class="external-link">future</a>
    </li>
    <li>
      <a href="https://future.apply.futureverse.org" class="external-link">future.apply</a>
    </li>
    <li>
      <a href="https://future.batchtools.futureverse.org" class="external-link">future.batchtools</a>
    </li>
    <li>
      <a href="https://future.callr.futureverse.org" class="external-link">future.callr</a>
    </li>
    <li>
      <a href="https://future.tests.futureverse.org" class="external-link">future.tests</a>
    </li>
    <li>
      <a href="https://globals.futureverse.org" class="external-link">globals</a>
    </li>
    <li>
      <a href="https://listenv.futureverse.org" class="external-link">listenv</a>
    </li>
    <li>
      <a href="https://parallelly.futureverse.org" class="external-link">parallelly</a>
    </li>
    <li>
      <a href="https://progressr.futureverse.org">progressr</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://cloud.r-project.org/package=progressr" class="external-link">
    <span class="fab fa-r-project"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/HenrikBengtsson/progressr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>progressr: An Introduction</h1>
                        <h4 data-toc-skip class="author">Henrik
Bengtsson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HenrikBengtsson/progressr/blob/HEAD/vignettes/progressr-intro.md" class="external-link"><code>vignettes/progressr-intro.md</code></a></small>
      <div class="hidden name"><code>progressr-intro.md</code></div>

    </div>

    
    
<!--
%\VignetteIndexEntry{progressr: An Introduction}
%\VignetteAuthor{Henrik Bengtsson}
%\VignetteKeyword{R}
%\VignetteKeyword{package}
%\VignetteKeyword{vignette}
%\VignetteKeyword{Rprofile}
%\VignetteKeyword{Renviron}
%\VignetteEngine{progressr::selfonly}
-->
<!-- DO NOT EDIT THIS FILE! Edit 'OVERVIEW.md' instead and then rebuild this file with 'make vigs' -->
<p>The <strong><a href="https://cran.r-project.org/package=progressr" class="external-link">progressr</a></strong>
package provides a minimal API for reporting progress updates in <a href="https://www.r-project.org/" class="external-link">R</a>. The design is to separate the
representation of progress updates from how they are presented. What
type of progress to signal is controlled by the developer. How these
progress updates are rendered is controlled by the end user. For
instance, some users may prefer visual feedback such as a horizontal
progress bar in the terminal, whereas others may prefer auditory
feedback.</p>
<p><img src="imgs/three_in_chinese.gif" alt="Three strokes writing three in Chinese" style="float: right; margin-right: 1ex; margin-left: 1ex;"></p>
<p>Design motto:</p>
<blockquote>
<p>The developer is responsible for providing progress updates but it’s
only the end user who decides if, when, and how progress should be
presented. No exceptions will be allowed.</p>
</blockquote>
<div class="section level2">
<h2 id="two-minimal-apis---one-for-developers-and-one-for-end-users">Two Minimal APIs - One For Developers and One For End-Users<a class="anchor" aria-label="anchor" href="#two-minimal-apis---one-for-developers-and-one-for-end-users"></a>
</h2>
<div style="overflow: hidden">
<div style="float: left">
<table style="border: 1px solid #999; box-shadow: 2px 2px 2px #999;" class="table">
<tr>
<th>
Developer’s API
</th>
</tr>
<tr style="vertical-align: top">
<td>
<p>
</p>
<ol style="list-style-type: decimal">
<li>Set up a progressor with a certain number of steps:</li>
</ol>
<pre>
p &lt;- progressor(nsteps)
p &lt;- progressor(along = x)
</pre>
<p>
</p>
<ol start="2" style="list-style-type: decimal">
<li>Signal progress:</li>
</ol>
<pre>
p()               # one-step progress
p(amount = 0)     # "still alive"
p("loading ...")  # pass on a message
</pre>
</td>
</tr>
</table>
</div>
<div style="float: left">
    
</div>
<div style="float: left">
<table style="border: 1px solid #999; box-shadow: 2px 2px 2px #999;" class="table">
<tr>
<th>
End-user’s API
</th>
</tr>
<tr style="vertical-align: top">
<td>
<p>
1a. Subscribe to progress updates from everywhere:
</p>
<pre>
handlers(global = TRUE)

y &lt;- slow_sum(1:5)
y &lt;- slow_sum(6:10)
</pre>
<p>
1b. Subscribe to a specific expression:
</p>
<pre>
with_progress({
  y &lt;- slow_sum(1:5)
  y &lt;- slow_sum(6:10)
})
</pre>
<p>
</p>
<ol start="2" style="list-style-type: decimal">
<li>Configure how progress is presented:</li>
</ol>
<pre>
handlers("progress")
handlers("txtprogressbar", "beepr")
handlers(handler_pbcol(enable_after = 3.0))
handlers(handler_progress(complete = "#"))
</pre>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="a-simple-example">A simple example<a class="anchor" aria-label="anchor" href="#a-simple-example"></a>
</h2>
<p>Assume that we have a function <code><a href="../reference/slow_sum.html">slow_sum()</a></code> for adding up
the values in a vector. It is so slow, that we like to provide progress
updates to whoever might be interested in it. With the
<strong>progressr</strong> package, this can be done as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slow_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">sum</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">kk</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="va">sum</span> <span class="op">&lt;-</span> <span class="va">sum</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span>message <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Adding %g"</span>, <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">sum</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note how there are <em>no</em> arguments in the code that specifies
how progress is presented. The only task for the developer is to decide
on where in the code it makes sense to signal that progress has been
made. As we will see next, it is up to the end user of this code to
decide whether they want to receive progress updates or not, and, if so,
in what format.</p>
<div class="section level3">
<h3 id="without-reporting-on-progress">Without reporting on progress<a class="anchor" aria-label="anchor" href="#without-reporting-on-progress"></a>
</h3>
<p>When calling this function as in:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">55</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span></span></code></pre></div>
<p>it will behave as any function and there will be no progress updates
displayed.</p>
</div>
<div class="section level3">
<h3 id="reporting-on-progress">Reporting on progress<a class="anchor" aria-label="anchor" href="#reporting-on-progress"></a>
</h3>
<p>If we are only interested in progress for a particular call, we can
do:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(progressr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">with_progress</span>(y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span><span class="er">====================</span>                               <span class="er">|</span>  <span class="dv">40</span>%</span></code></pre></div>
<p>However, if we want to report on progress from <em>every</em> call,
wrapping the calls in <code><a href="../reference/with_progress.html">with_progress()</a></code> might become too
cumbersome. If so, we can enable the global progress handler:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(progressr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>so that progress updates are reported on wherever signaled, e.g.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span><span class="er">====================</span>                               <span class="er">|</span>  <span class="dv">40</span>%</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span><span class="er">========================================</span>           <span class="er">|</span>  <span class="dv">80</span>%</span></code></pre></div>
<p>This requires R 4.0.0 or newer. To disable this again, do:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>In the below examples, we will assume
<code>handlers(global = TRUE)</code> is already set.</p>
</div>
</div>
<div class="section level2">
<h2 id="customizing-how-progress-is-reported">Customizing how progress is reported<a class="anchor" aria-label="anchor" href="#customizing-how-progress-is-reported"></a>
</h2>
<div class="section level3">
<h3 id="terminal-based-progress-bars">Terminal-based progress bars<a class="anchor" aria-label="anchor" href="#terminal-based-progress-bars"></a>
</h3>
<p>The default is to present progress via
<code><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">utils::txtProgressBar()</a></code>, which is available on all R
installations. It presents itself as an ASCII-based horizontal progress
bar in the R terminal. This is rendered as:</p>
<div class="figure">
<img src="imgs/handler_txtprogressbar-default.svg" alt=""><p class="caption">SVG animation of the default “txtprogressbar”
progress handler</p>
</div>
<p>We can tweak this “txtprogressbar” handler to use red hearts for the
bar, e.g.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="fu"><a href="../reference/handler_txtprogressbar.html">handler_txtprogressbar</a></span><span class="op">(</span>char <span class="op">=</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html" class="external-link">col_red</a></span><span class="op">(</span><span class="fu">cli</span><span class="fu">::</span><span class="va"><a href="https://cli.r-lib.org/reference/symbol.html" class="external-link">symbol</a></span><span class="op">$</span><span class="va">heart</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>which results in:</p>
<div class="figure">
<img src="imgs/handler_txtprogressbar-char-ansi.svg" alt=""><p class="caption">SVG animation of the “txtprogressbar” progress
handler with red hearts</p>
</div>
<p>Another example is:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="fu"><a href="../reference/handler_pbcol.html">handler_pbcol</a></span><span class="op">(</span></span>
<span>      adjust <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    complete <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html" class="external-link">bg_red</a></span><span class="op">(</span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html" class="external-link">col_black</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  incomplete <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html" class="external-link">bg_cyan</a></span><span class="op">(</span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html" class="external-link">col_black</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>which results in:</p>
<div class="figure">
<img src="imgs/handler_pbcol-adjust-right-complete.svg" alt=""><p class="caption">SVG animation of the “pbcol” progress handler with
text aligned to the right</p>
</div>
<p>To change the default, to, say, <code>cli_progress_bar()</code> by
the <strong><a href="https://cran.r-project.org/package=cli" class="external-link">cli</a></strong> package,
set:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"cli"</span><span class="op">)</span></span></code></pre></div>
<p>This progress handler will present itself as:</p>
<div class="figure">
<img src="imgs/handler_cli-default.svg" alt=""><p class="caption">SVG animation of the default “cli” progress
handler</p>
</div>
<p>To instead use <code>progress_bar()</code> by the <strong><a href="https://cran.r-project.org/package=progress" class="external-link">progress</a></strong>
package, set:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"progress"</span><span class="op">)</span></span></code></pre></div>
<p>This progress handler will present itself as:</p>
<div class="figure">
<img src="imgs/handler_progress-default.svg" alt=""><p class="caption">SVG animation of the default “progress” progress
handler</p>
</div>
<p>To set the default progress handler, or handlers, in all your R
sessions, call <code>progressr::handlers(...)</code> in your
<code>~/.Rprofile</code> startup file.</p>
</div>
<div class="section level3">
<h3 id="auditory-progress-updates">Auditory progress updates<a class="anchor" aria-label="anchor" href="#auditory-progress-updates"></a>
</h3>
<p>Progress updates do not have to be presented visually. They can
equally well be communicated via audio. For example, using:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"beepr"</span><span class="op">)</span></span></code></pre></div>
<p>will present itself as sounds played at the beginning, while
progressing, and at the end (using different <strong><a href="https://cran.r-project.org/package=beepr" class="external-link">beepr</a></strong>
sounds). There will be <em>no</em> output written to the terminal;</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">55</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="concurrent-auditory-and-visual-progress-updates">Concurrent auditory and visual progress updates<a class="anchor" aria-label="anchor" href="#concurrent-auditory-and-visual-progress-updates"></a>
</h3>
<p>It is possible to have multiple progress handlers presenting progress
updates at the same time. For example, to get both visual and auditory
updates, use:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"txtprogressbar"</span>, <span class="st">"beepr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="silence-all-progress">Silence all progress<a class="anchor" aria-label="anchor" href="#silence-all-progress"></a>
</h3>
<p>To silence all progress updates, use:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"void"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="further-configuration-of-progress-handlers">Further configuration of progress handlers<a class="anchor" aria-label="anchor" href="#further-configuration-of-progress-handlers"></a>
</h3>
<p>Above we have seen examples where the <code><a href="../reference/handlers.html">handlers()</a></code> takes
one or more strings as input,
e.g. <code>handlers(c("progress", "beepr"))</code>. This is short for a
more flexible specification where we can pass a list of handler
functions, e.g.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/handler_progress.html">handler_progress</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/handler_beepr.html">handler_beepr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>With this construct, we can make adjustments to the default behavior
of these progress handlers. For example, we can configure the
<code>format</code>, <code>width</code>, and <code>complete</code>
arguments of <code>progress::progress_bar$new()</code>, and tell
<strong>beepr</strong> to use a different <code>finish</code> sound and
generate sounds at most every two seconds by setting:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/handler_progress.html">handler_progress</a></span><span class="op">(</span></span>
<span>    format   <span class="op">=</span> <span class="st">":spin :current/:total (:message) [:bar] :percent in :elapsed ETA: :eta"</span>,</span>
<span>    width    <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    complete <span class="op">=</span> <span class="st">"+"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/handler_beepr.html">handler_beepr</a></span><span class="op">(</span></span>
<span>    finish   <span class="op">=</span> <span class="st">"wilhelm"</span>,</span>
<span>    interval <span class="op">=</span> <span class="fl">2.0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="sticky-messages">Sticky messages<a class="anchor" aria-label="anchor" href="#sticky-messages"></a>
</h2>
<p>As seen above, some progress handlers present the progress message as
part of its output, e.g. the “progress” handler will display the message
as part of the progress bar. It is also possible to “push” the message
up together with other terminal output. This can be done by adding class
attribute <code>"sticky"</code> to the progression signaled. This works
for several progress handlers that output to the terminal. For example,
with:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slow_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">sum</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">kk</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="va">sum</span> <span class="op">&lt;-</span> <span class="va">sum</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Step %d"</span>, <span class="va">kk</span><span class="op">)</span>, class <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">kk</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">5</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="st">"sticky"</span>, amount <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span>message <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Adding %g"</span>, <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">sum</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>we get</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="st">"txtprogressbar"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>Step <span class="dv">5</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Step <span class="dv">10</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span><span class="er">====================</span>                               <span class="er">|</span>  <span class="dv">43</span>%</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="st">"progress"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Step <span class="dv">5</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>Step <span class="dv">10</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span> [<span class="sc">==</span><span class="er">=============&gt;</span><span class="sc">-------------------------</span>]  <span class="dv">43</span>% Adding <span class="dv">13</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use-regular-output-as-usual-alongside-progress-updates">Use regular output as usual alongside progress updates<a class="anchor" aria-label="anchor" href="#use-regular-output-as-usual-alongside-progress-updates"></a>
</h2>
<p>In contrast to other progress-bar frameworks, output from
<code><a href="https://rdrr.io/r/base/message.html" class="external-link">message()</a></code>, <code><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat()</a></code>, <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and so
on, will <em>not</em> interfere with progress reported via
<strong>progressr</strong>. For example, say we have:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slow_sqrt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Calculating the square root of "</span>, <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>we will get:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(progressr)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="st">"progress"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sqrt</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>Calculating the square root of <span class="dv">1</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>Calculating the square root of <span class="dv">2</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> [<span class="sc">==</span><span class="er">=========&gt;</span><span class="sc">-----------------------------------</span>]  <span class="dv">25</span>% x<span class="ot">=</span><span class="dv">2</span></span></code></pre></div>
<p>This works because <strong>progressr</strong> will briefly buffer any
output internally and only release it when the next progress update is
received just before the progress is re-rendered in the terminal. This
is why you see a two second delay when running the above example. Note
that, if we use progress handlers that do not output to the terminal,
such as <code>handlers("beepr")</code>, then output does not have to be
buffered and will appear immediately.</p>
<p><em>Comment</em>: When signaling a warning using
<code>warning(msg, immediate. = TRUE)</code> the message is immediately
outputted to the standard-error stream. However, this is not possible to
emulate when warnings are intercepted using calling handlers, which are
used by <code><a href="../reference/with_progress.html">with_progress()</a></code>. This is a limitation of R that
cannot be worked around. Because of this, the above call will behave the
same as <code>warning(msg)</code> - that is, all warnings will be
buffered by R internally and released only when all computations are
done.</p>
</div>
<div class="section level2">
<h2 id="support-for-progressr-elsewhere">Support for progressr elsewhere<a class="anchor" aria-label="anchor" href="#support-for-progressr-elsewhere"></a>
</h2>
<p>Note that progression updates by <strong>progressr</strong> is
designed to work out of the box for any iterator framework in R. Below
is an set of examples for the most common ones.</p>
<div class="section level3">
<h3 id="base-r-apply-functions">Base R Apply Functions<a class="anchor" aria-label="anchor" href="#base-r-apply-functions"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#  |====================                               |  40%</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-foreach-package">The foreach package<a class="anchor" aria-label="anchor" href="#the-foreach-package"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/foreach" class="external-link">foreach</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xs</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%do%</a></span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#  |====================                               |  40%</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-purrr-package">The purrr package<a class="anchor" aria-label="anchor" href="#the-purrr-package"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#  |====================                               |  40%</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-plyr-package">The plyr package<a class="anchor" aria-label="anchor" href="#the-plyr-package"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/llply.html" class="external-link">llply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#  |====================                               |  40%</span></span></code></pre></div>
<p>Note how this solution does not make use of <strong>plyr</strong>’s
<code>.progress</code> argument, because the above solution is more
powerful and more flexible, e.g. we have more control on progress
updates and their messages. However, if you prefer the traditional
<strong>plyr</strong> approach, you can use
<code>.progress = "progressr"</code>,
e.g. <code>y &lt;- llply(..., .progress = "progressr")</code>.</p>
</div>
<div class="section level3">
<h3 id="the-knitr-package">The knitr package<a class="anchor" aria-label="anchor" href="#the-knitr-package"></a>
</h3>
<p>When compiling (“knitting”) an knitr-based vignette, for instance,
via <code><a href="https://rdrr.io/pkg/knitr/man/knit.html" class="external-link">knitr::knit()</a></code>, <strong><a href="https://cran.r-project.org/package=knitr" class="external-link">knitr</a></strong> shows
the progress of code chunks processed thus far using a progress bar. In
<strong>knitr</strong> (&gt;= 1.42) [to be released as of 2022-12-12],
we can use <strong>progressr</strong> for this progress reporting. To do
this, set R option <code>knitr.progress.fun</code> as:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.progress.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">total</span>, <span class="va">labels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span><span class="va">total</span>, on_exit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    update <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"chunk: %s"</span>, <span class="va">labels</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    done <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"finish"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>This configures <strong>knitr</strong> to signal progress via the
<strong>progressr</strong> framework. To report on these, use:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="replace-any-cli-progress-bars-with-progressr-updates">Replace any cli progress bars with progressr updates<a class="anchor" aria-label="anchor" href="#replace-any-cli-progress-bars-with-progressr-updates"></a>
</h3>
<p>The <strong>cli</strong> package is used for progress reporting by
many several packages, notably tidyverse package. For instance, in
<strong>purrr</strong>, you can do:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, .progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>to render a traditional <strong>cli</strong> progress bar as
<code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code> is iterating over the elements. Instead of using the
built-in <strong>cli</strong> progress bar, we can customize
<strong>cli</strong> to report on progress via
<strong>progressr</strong> instead. To do this, set R option
<code>cli.progress_handlers</code> as:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>cli.progress_handlers <span class="op">=</span> <span class="st">"progressr"</span><span class="op">)</span></span></code></pre></div>
<p>With this option set, <strong>cli</strong> will now report on
progress according to your <code><a href="../reference/handlers.html">progressr::handlers()</a></code> settings.
For example, with:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beepr"</span>, <span class="st">"rstudio"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>will report on progress using <strong>beepr</strong> and the RStudio
Console progress panel.</p>
<p>To make <strong>cli</strong> report via <strong>progressr</strong> in
all your R session, set the above R option in your
<code>~/.Rprofile</code> startup file.</p>
</div>
</div>
<div class="section level2">
<h2 id="parallel-processing-and-progress-updates">Parallel processing and progress updates<a class="anchor" aria-label="anchor" href="#parallel-processing-and-progress-updates"></a>
</h2>
<p>The <strong><a href="https://cran.r-project.org/package=future" class="external-link">future</a></strong>
framework, which provides a unified API for parallel and distributed
processing in R, has built-in support for the kind of progression
updates produced by the <strong>progressr</strong> package. This means
that you can use it with for instance <strong><a href="https://cran.r-project.org/package=future.apply" class="external-link">future.apply</a></strong>,
<strong><a href="https://cran.r-project.org/package=furrr" class="external-link">furrr</a></strong>, and
<strong><a href="https://cran.r-project.org/package=foreach" class="external-link">foreach</a></strong>
with <strong><a href="https://cran.r-project.org/package=doFuture" class="external-link">doFuture</a></strong>,
and <strong><a href="https://cran.r-project.org/package=plyr" class="external-link">plyr</a></strong> or
<strong><a href="https://www.bioconductor.org/packages/BiocParallel/" class="external-link">BiocParallel</a></strong>
with <strong>doFuture</strong>. In contrast, <em>non-future</em>
parallelization methods such as <strong>parallel</strong>’s
<code>mclapply()</code> and, <code><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parallel::parLapply()</a></code>, and
<strong>foreach</strong> adapters like <strong>doParallel</strong> do
<em>not</em> support progress reports via
<strong>progressr</strong>.</p>
<div class="section level3">
<h3 id="future_lapply---parallel-lapply">future_lapply() - parallel lapply()<a class="anchor" aria-label="anchor" href="#future_lapply---parallel-lapply"></a>
</h3>
<p>Here is an example that uses <code><a href="https://future.apply.futureverse.org/reference/future_lapply.html" class="external-link">future_lapply()</a></code> of the
<strong><a href="https://cran.r-project.org/package=future.apply" class="external-link">future.apply</a></strong>
package to parallelize on the local machine while at the same time
signaling progression updates:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.apply.futureverse.org" class="external-link">future.apply</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"progress"</span>, <span class="st">"beepr"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://future.apply.futureverse.org/reference/future_lapply.html" class="external-link">future_lapply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">6.0</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># / [================&gt;-----------------------------]  40% x=2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="foreach-with-dofuture">foreach() with doFuture<a class="anchor" aria-label="anchor" href="#foreach-with-dofuture"></a>
</h3>
<p>Here is an example that uses <code><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach()</a></code> of the <strong><a href="https://cran.r-project.org/package=foreach" class="external-link">foreach</a></strong>
package to parallelize on the local machine (via <strong><a href="https://cran.r-project.org/package=doFuture" class="external-link">doFuture</a></strong>)
while at the same time signaling progression updates:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html" class="external-link">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span>      <span class="co">## %dopar% parallelizes via future</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"progress"</span>, <span class="st">"beepr"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xs</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">6.0</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># / [================&gt;-----------------------------]  40% x=2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="future_map---parallel-purrrmap">future_map() - parallel purrr::map()<a class="anchor" aria-label="anchor" href="#future_map---parallel-purrrmap"></a>
</h3>
<p>Here is an example that uses <code><a href="https://furrr.futureverse.org/reference/future_map.html" class="external-link">future_map()</a></code> of the
<strong><a href="https://cran.r-project.org/package=furrr" class="external-link">furrr</a></strong>
package to parallelize on the local machine while at the same time
signaling progression updates:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavisVaughan/furrr" class="external-link">furrr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"progress"</span>, <span class="st">"beepr"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://furrr.futureverse.org/reference/future_map.html" class="external-link">future_map</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">6.0</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># / [================&gt;-----------------------------]  40% x=2</span></span></code></pre></div>
<p><em>Note:</em> This solution does not involved the
<code>.progress = TRUE</code> argument that <strong>furrr</strong>
implements. Because <strong>progressr</strong> is more generic and
because <code>.progress = TRUE</code> only supports certain future
backends and produces errors on non-supported backends, I recommended to
stop using <code>.progress = TRUE</code> and use the
<strong>progressr</strong> package instead.</p>
</div>
<div class="section level3">
<h3 id="biocparallelbplapply---parallel-lapply">BiocParallel::bplapply() - parallel lapply()<a class="anchor" aria-label="anchor" href="#biocparallelbplapply---parallel-lapply"></a>
</h3>
<p>Here is an example that uses <code><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply()</a></code> of the
<strong><a href="https://www.bioconductor.org/packages/BiocParallel/" class="external-link">BiocParallel</a></strong>
package to parallelize on the local machine while at the same time
signaling progression updates:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/DoparParam-class.html" class="external-link">DoparParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="co">## BiocParallel parallelizes via %dopar%</span></span>
<span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html" class="external-link">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span>      <span class="co">## %dopar% parallelizes via future</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"progress"</span>, <span class="st">"beepr"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">6.0</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># / [================&gt;-----------------------------]  40% x=2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plyrllply--parallel-true-with-dofuture">plyr::llply(…, .parallel = TRUE) with doFuture<a class="anchor" aria-label="anchor" href="#plyrllply--parallel-true-with-dofuture"></a>
</h3>
<p>Here is an example that uses <code><a href="https://rdrr.io/pkg/plyr/man/llply.html" class="external-link">llply()</a></code> of the <strong><a href="https://cran.r-project.org/package=plyr" class="external-link">plyr</a></strong> package
to parallelize on the local machine while at the same time signaling
progression updates:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html" class="external-link">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span>      <span class="co">## %dopar% parallelizes via future</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="st">"progress"</span>, <span class="st">"beepr"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/llply.html" class="external-link">llply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">6.0</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span>, .parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># / [================&gt;-----------------------------]  40% x=2</span></span></code></pre></div>
<p><em>Note:</em> As an alternative to the above, recommended approach,
one can use <code>.progress = "progressr"</code> together with
<code>.parallel = TRUE</code>. This requires <strong>plyr</strong>
(&gt;= 1.8.7).</p>
</div>
<div class="section level3">
<h3 id="near-live-versus-buffered-progress-updates-with-futures">Near-live versus buffered progress updates with futures<a class="anchor" aria-label="anchor" href="#near-live-versus-buffered-progress-updates-with-futures"></a>
</h3>
<p>As of November 2020, there are four types of <strong>future</strong>
backends that are known(*) to provide near-live progress updates:</p>
<ol style="list-style-type: decimal">
<li>
<code>sequential</code>,</li>
<li>
<code>multicore</code>,</li>
<li>
<code>multisession</code>, and</li>
<li>
<code>cluster</code> (local and remote)</li>
</ol>
<p>Here “near-live” means that the progress handlers will report on
progress almost immediately when the progress is signaled on the worker.
For all other future backends, the progress updates are only relayed
back to the main machine and reported together with the results of the
futures. For instance, if <code>future_lapply(X, FUN)</code> chunks up
the processing of, say, 100 elements in <code>X</code> into eight
futures, we will see progress from each of the 100 elements as they are
done when using a future backend supporting “near-live” updates, whereas
we will only see those updated to be flushed eight times when using any
other types of future backends.</p>
<p>(*) Other future backends may gain support for “near-live” progress
updating later. Adding support for those is independent of the
<strong>progressr</strong> package. Feature requests for adding that
support should go to those future-backend packages.</p>
</div>
</div>
<div class="section level2">
<h2 id="note-of-caution---sending-progress-updates-too-frequently">Note of caution - sending progress updates too frequently<a class="anchor" aria-label="anchor" href="#note-of-caution---sending-progress-updates-too-frequently"></a>
</h2>
<p>Signaling progress updates comes with some overhead. In situation
where we use progress updates, this overhead is typically much smaller
than the task we are processing in each step. However, if the task we
iterate over is quick, then the extra time induced by the progress
updates might end up dominating the overall processing time. If that is
the case, a simple solution is to only signal progress updates every
n:th step. Here is a version of <code><a href="../reference/slow_sum.html">slow_sum()</a></code> that signals
progress every 10:th iteration:</p>
<pre><code><span><span class="va">slow_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">sum</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">kk</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="va">sum</span> <span class="op">&lt;-</span> <span class="va">sum</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">kk</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">10</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span>message <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Adding %g"</span>, <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">sum</span></span>
<span><span class="op">}</span></span></code></pre>
<p>The overhead of progress signaling may depend on context. For
example, in parallel processing with near-live progress updates via
‘multisession’ futures, each progress update is communicated via a
socket connections back to the main R session. These connections might
become clogged up if progress updates are too frequent.</p>
</div>
<div class="section level2">
<h2 id="progress-updates-in-non-interactive-mode-batch-mode">Progress updates in non-interactive mode (“batch mode”)<a class="anchor" aria-label="anchor" href="#progress-updates-in-non-interactive-mode-batch-mode"></a>
</h2>
<p>When running R from the command line, R runs in a non-interactive
mode (<code><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive()</a></code> returns <code>FALSE</code>). The
default behavior of <strong>progressr</strong> is to <em>not</em> report
on progress in non-interactive mode. To reported on progress also then,
set R options <code>progressr.enable</code> or environment variable
<code>R_PROGRESSR_ENABLE</code> to <code>TRUE</code>. For example,</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> Rscript <span class="at">-e</span> <span class="st">"library(progressr)"</span> <span class="at">-e</span> <span class="st">"with_progress(y &lt;- slow_sum(1:10))"</span></span></code></pre></div>
<p>will <em>not</em> report on progress, whereas</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> export R_PROGRESSR_ENABLE=TRUE</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> Rscript <span class="at">-e</span> <span class="st">"library(progressr)"</span> <span class="at">-e</span> <span class="st">"with_progress(y &lt;- slow_sum(1:10))"</span></span></code></pre></div>
<p>will.</p>
</div>
<div class="section level2">
<h2 id="roadmap">Roadmap<a class="anchor" aria-label="anchor" href="#roadmap"></a>
</h2>
<p>Because this project is under active development, the progressr API
is currently kept at a very minimum. This will allow for the framework
and the API to evolve while minimizing the risk for breaking code that
depends on it. The roadmap for developing the API is roughly:</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled checked>
Provide minimal API for producing progress updates,
i.e. <code><a href="../reference/progressor.html">progressor()</a></code>, <code><a href="../reference/with_progress.html">with_progress()</a></code>,
<code><a href="../reference/handlers.html">handlers()</a></code></p></li>
<li><p><input type="checkbox" disabled checked>
Add support for global progress handlers removing the need for the user
having to specify <code><a href="../reference/with_progress.html">with_progress()</a></code>,
i.e. <code>handlers(global = TRUE)</code> and
<code>handlers(global = FALSE)</code></p></li>
<li><p><input type="checkbox" disabled>
Make it possible to create a progressor also in the global environment
(see ‘Known issues’ below)</p></li>
<li><p><input type="checkbox" disabled>
Add support for nested progress updates</p></li>
<li><p><input type="checkbox" disabled>
Add API to allow users and package developers to design additional
progression handlers</p></li>
</ul>
<p>For a more up-to-date view on what features might be added, see <a href="https://github.com/HenrikBengtsson/progressr/issues" class="external-link uri">https://github.com/HenrikBengtsson/progressr/issues</a>.</p>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="known-issues">Known issues<a class="anchor" aria-label="anchor" href="#known-issues"></a>
</h3>
<div class="section level4">
<h4 id="a-progressor-cannot-be-created-in-the-global-environment">A progressor cannot be created in the global environment<a class="anchor" aria-label="anchor" href="#a-progressor-cannot-be-created-in-the-global-environment"></a>
</h4>
<p>It is not possible to create a progressor in the global environment,
e.g. in the the top-level of a script. It has to be created inside a
function, within <code>with_progress({ ... })</code>,
<code>local({ ... })</code>, or a similar construct. For example, the
following:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>results in an error if tried:</p>
<pre><code>Error in progressor(along = xs) : 
  A progressor must not be created in the global environment unless wrapped in a
  with_progress() or without_progress() call. Alternatively, create it inside a
  function or in a local() environment to make sure there is a finite life span
  of the progressor</code></pre>
<p>The solution is to wrap it in a <code>local({ ... })</code> call, or
more explicitly, in a <code>with_progress({ ... })</code> call:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="fu"><a href="../reference/with_progress.html">with_progress</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#  |====================                               |  40%</span></span></code></pre></div>
<p>The main reason for this is to limit the life span of each
progressor. If we created it in the global environment, there is a
significant risk it would never finish and block all of the following
progressors.</p>
</div>
<div class="section level4">
<h4 id="the-global-progress-handler-cannot-be-set-everywhere">The global progress handler cannot be set everywhere<a class="anchor" aria-label="anchor" href="#the-global-progress-handler-cannot-be-set-everywhere"></a>
</h4>
<p>It is <em>not</em> possible to call
<code>handlers(global = TRUE)</code> in all circumstances. For example,
it cannot be called within <code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code> and
<code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">withCallingHandlers()</a></code>;</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">tryCatch</span>(<span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">TRUE</span>), <span class="at">error =</span> identity)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">globalCallingHandlers</span>(<span class="cn">NULL</span>) <span class="sc">:</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  should not be called with handlers on the stack</span></code></pre></div>
<p>This is not a bug - neither in <strong>progressr</strong> nor in R
itself. It’s due to a conservative design on how <em>global</em> calling
handlers should work in R. If it allowed, there’s a risk we might end up
getting weird and unpredictable behaviors when messages, warnings,
errors, and other types of conditions are signaled.</p>
<p>Because <code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code> and
<code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">withCallingHandlers()</a></code> is used in many places throughout
base R, this means that we also cannot call
<code>handlers(global = TRUE)</code> as part of a package’s startup
process, e.g. <code>.onLoad()</code> or <code>.onAttach()</code>.</p>
<p>Another example of this error is if
<code>handlers(global = TRUE)</code> is used inside package vignettes
and dynamic documents such as Rmarkdown. In such cases, the global
progress handler has to be enabled <em>prior</em> to processing the
document, e.g.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> progressr<span class="sc">::</span><span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">render</span>(<span class="st">"input.Rmd"</span>)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="under-the-hood">Under the hood<a class="anchor" aria-label="anchor" href="#under-the-hood"></a>
</h3>
<p>When using the <strong>progressr</strong> package, progression
updates are communicated via R’s condition framework, which provides
methods for creating, signaling, capturing, muffling, and relaying
conditions. Progression updates are of classes <code>progression</code>
and <code>immediateCondition</code>(*). The below figure gives an
example how progression conditions are created, signaled, and
rendered.</p>
<p>(*) The <code>immediateCondition</code> class of conditions are
relayed as soon as possible by the <strong><a href="https://cran.r-project.org/package=future" class="external-link">future</a></strong>
framework, which means that progression updates produced in parallel
workers are reported to the end user as soon as the main R session have
received them.</p>
<p><img src="imgs/slow_sum.svg"></p>
<p><em>Figure: Sequence diagram illustrating how signaled progression
conditions are captured by <code><a href="../reference/with_progress.html">with_progress()</a></code>, or the global
progression handler, and relayed to the two progression handlers
‘progress’ (a progress bar in the terminal) and ‘beepr’ (auditory) that
the end user has chosen.</em></p>
</div>
<div class="section level3">
<h3 id="debugging">Debugging<a class="anchor" aria-label="anchor" href="#debugging"></a>
</h3>
<p>To debug progress updates, use:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="st">"debug"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">with_progress</span>(y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">52.738</span>] (<span class="fl">0.000</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.002</span>s) initiate<span class="sc">:</span> <span class="dv">0</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">''</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">52.739</span>] (<span class="fl">0.001</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.000</span>s) update<span class="sc">:</span> <span class="dv">0</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">''</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">52.942</span>] (<span class="fl">0.203</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.002</span>s) update<span class="sc">:</span> <span class="dv">0</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">''</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">53.145</span>] (<span class="fl">0.407</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">0</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">''</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">53.348</span>] (<span class="fl">0.610</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.002</span>s) update<span class="sc">:</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">1</span>) <span class="st">'P: Adding 1'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>M<span class="sc">:</span> Adding value <span class="dv">1</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">53.555</span>] (<span class="fl">0.817</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.004</span>s) update<span class="sc">:</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 1'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">53.758</span>] (<span class="fl">1.020</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 1'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">53.961</span>] (<span class="fl">1.223</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 1'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">54.165</span>] (<span class="fl">1.426</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 1'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">54.368</span>] (<span class="fl">1.630</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">1</span>) <span class="st">'P: Adding 2'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>M<span class="sc">:</span> Adding value <span class="dv">2</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">54.574</span>] (<span class="fl">1.835</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.003</span>s) update<span class="sc">:</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 2'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">54.777</span>] (<span class="fl">2.039</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 2'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">54.980</span>] (<span class="fl">2.242</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 2'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">55.183</span>] (<span class="fl">2.445</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 2'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">55.387</span>] (<span class="fl">2.649</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.001</span>s) update<span class="sc">:</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">1</span>) <span class="st">'P: Adding 3'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">55.388</span>] (<span class="fl">2.650</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.003</span>s) update<span class="sc">:</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 3'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>}</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>M<span class="sc">:</span> Adding value <span class="dv">3</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span><span class="sc">:</span><span class="dv">19</span><span class="sc">:</span><span class="fl">55.795</span>] (<span class="fl">3.057</span><span class="at">s =</span><span class="sc">&gt;</span> <span class="sc">+</span><span class="fl">0.000</span>s) shutdown<span class="sc">:</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">3</span> (<span class="sc">+</span><span class="dv">0</span>) <span class="st">'P: Adding 3'</span> {clear<span class="ot">=</span><span class="cn">TRUE</span>, enabled<span class="ot">=</span><span class="cn">TRUE</span>, status<span class="ot">=</span>ok}</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Henrik Bengtsson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9005.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'aa6e02fc501886fb0f7c91ac4e300456',
    indexName: 'futureverse',
    algoliaOptions: { 'facetFilters': ['project:progressr'] },
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
